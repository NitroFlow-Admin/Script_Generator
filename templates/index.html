<!DOCTYPE html>
<html>
<head>
  <title>Cold Call Script Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      padding: 2rem;
    }
    h1 {
      margin-bottom: 1rem;
      color: #333;
    }
    .section {
      background: #fff;
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .section h3 {
      margin-top: 0;
      color: #007BFF;
    }
    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }
    input[type="text"], textarea {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-size: 1rem;
    }
    .qa-blocks {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }
    .qa-box {
      background: #ffffff;
      padding: 1rem;
      border-left: 5px solid #007BFF;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.03);
      font-size: 1rem;
    }
    .qa-label {
      color: #007BFF;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }
    .qa-prompt {
      margin-bottom: 0.5rem;
    }
    .version-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .version-buttons button {
      width: 30px;
      height: 30px;
      border: none;
      border-radius: 6px;
      background-color: #eee;
      font-weight: bold;
      cursor: pointer;
    }
    .version-buttons button.active {
      background-color: #007BFF;
      color: white;
    }
    .button {
      padding: 0.75rem 1.5rem;
      background: #007BFF;
      color: #fff;
      border: none;
      border-radius: 4px;
      text-decoration: none;
      font-size: 1rem;
    }
    .button:hover {
      background: #0056b3;
    }
  </style>
</head>
<body>

  <h1>Cold Call Script Generator</h1>

  <form action="/" method="POST">
    <!-- Rep Info -->
    <div class="section">
      <h3>Sales Rep Info</h3>
      <label for="rep_name">Your Name:</label>
      <input type="text" name="rep_name" value="{{ rep_data.rep_name }}">

      <label for="rep_company">Your Company:</label>
      <input type="text" name="rep_company" value="{{ rep_data.rep_company }}">

      <label for="product">Product or Service:</label>
      <input type="text" name="product" value="{{ rep_data.product }}">

      <label for="objection_needs">Needs Objection:</label>
      <input type="text" name="objection_needs" value="{{ rep_data.objection_needs }}">

      <label for="objection_service">Service Objection:</label>
      <input type="text" name="objection_service" value="{{ rep_data.objection_service }}">

      <label for="objection_source">Source Objection:</label>
      <input type="text" name="objection_source" value="{{ rep_data.objection_source }}">

      <label for="objection_price">Price Objection:</label>
      <input type="text" name="objection_price" value="{{ rep_data.objection_price }}">

      <label for="objection_time">Time Objection:</label>
      <input type="text" name="objection_time" value="{{ rep_data.objection_time }}">
    </div>

    <!-- Target Info -->
    <div class="section">
      <h3>Target Company Info</h3>
      <label for="target_name">Company Name:</label>
      <input type="text" name="target_name" value="{{ target_data.target_name }}">

      <label for="target_url">Company Website:</label>
      <input type="text" name="target_url" value="{{ target_data.target_url }}">

      <label for="recent_news">Recent News:</label>
      <textarea name="recent_news">{{ target_data.recent_news }}</textarea>

      <label for="locations">Company Locations:</label>
      <textarea name="locations">{{ target_data.locations }}</textarea>

      <label for="facts">Company Facts:</label>
      <textarea name="facts">{{ target_data.facts }}</textarea>

      <label for="products_services">Products & Services:</label>
      <textarea name="products_services">{{ target_data.products_services }}</textarea>

      <label for="social_media">Social Media or Other Notes:</label>
      <textarea name="social_media">{{ target_data.social_media }}</textarea>
    </div>

    {% if script_items %}
    <div class="section">
      <h3>AI-Generated Sales Call Prompts</h3>
      <div class="qa-blocks">
        {% for item in script_items %}
          {% set group_index = loop.index %}
          <div class="qa-box" id="qa-box-{{ group_index }}">
            <div class="qa-label">{{ item.label }}</div>

            <!-- Editable Prompt Description -->
            <div class="qa-prompt">
              <label for="prompt-{{ group_index }}">Prompt Instruction:</label>
              <textarea name="prompt_descriptions" rows="2">{{ prompt_descriptions[loop.index0] }}</textarea>
            </div>

            <!-- Editable AI Output -->
            <div class="qa-output">
              <label for="qa-text-{{ group_index }}">Selected AI Output:</label>
              <textarea class="qa-text" id="qa-text-{{ group_index }}" rows="2">{{ item.options[0] if item.options|length > 0 else '' }}</textarea>
            </div>

            <!-- Version Buttons -->
            <div class="version-buttons">
              {% for opt in item.options %}
                <button 
                  type="button"
                  data-group="{{ group_index }}"
                  data-option="{{ loop.index0 }}"
                  id="btn-{{ group_index }}-{{ loop.index0 }}"
                  class="{% if loop.index0 == 0 %}active{% endif %}"
                  onclick="handleToggle(this)">
                  {{ loop.index }}
                </button>
              {% endfor %}
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    <button type="submit" class="button">Generate Script</button>

    
  </form>
  <form method="POST" action="/push-to-salesdrip">
    <input type="hidden" name="rep_email" value="{{ rep_data.rep_email }}">
    <input type="hidden" name="rep_name" value="{{ rep_data.rep_name }}">
    <input type="hidden" name="rep_company" value="{{ rep_data.rep_company }}">
    <input type="hidden" name="product" value="{{ rep_data.product }}">
    <input type="hidden" name="objection_needs" value="{{ rep_data.objection_needs }}">
    <input type="hidden" name="objection_service" value="{{ rep_data.objection_service }}">
    <input type="hidden" name="objection_source" value="{{ rep_data.objection_source }}">
    <input type="hidden" name="objection_price" value="{{ rep_data.objection_price }}">
    <input type="hidden" name="objection_time" value="{{ rep_data.objection_time }}">
  
    <input type="hidden" name="target_name" value="{{ target_data.target_name }}">
    <input type="hidden" name="target_url" value="{{ target_data.target_url }}">
    <input type="hidden" name="recent_news" value="{{ target_data.recent_news }}">
    <input type="hidden" name="locations" value="{{ target_data.locations }}">
    <input type="hidden" name="facts" value="{{ target_data.facts }}">
    <input type="hidden" name="products_services" value="{{ target_data.products_services }}">
    <input type="hidden" name="social_media" value="{{ target_data.social_media }}">
  
    {% for item in script_items %}
    <input type="hidden" name="script_item_{{ loop.index0 }}" value="{{ item.options[0] }}">
  {% endfor %}
  
  
    <button type="submit" style="margin-top: 1rem;">ðŸ“¤ Push to SalesDrip</button>
  </form>
  <!-- Inject data -->
  <script type="application/json" id="script-data">
    {{ script_items | tojson }}
  </script>

  <script>
    const scriptItems = JSON.parse(document.getElementById("script-data").textContent);

    function handleToggle(btn) {
      const groupIndex = parseInt(btn.getAttribute("data-group"));
      const optionIndex = parseInt(btn.getAttribute("data-option"));

      const qaText = document.getElementById(`qa-text-${groupIndex}`);
      qaText.value = scriptItems[groupIndex - 1].options[optionIndex];

      const buttons = document.querySelectorAll(`#qa-box-${groupIndex} .version-buttons button`);
      buttons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
    }
  </script>

</body>
</html>
